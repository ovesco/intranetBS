{% extends 'AppBundle:Layout:layout.html.twig' %}

{% import 'AppBundle:Macros:attribution_macro.html.twig' as attrsMacros %}

{% block titre %}
    {{ membre.prenom }} {{ membre.nom }}
{% endblock %}

{% form_theme membreForm 'Templates/form_to_xEditable.html.twig' %}


{% block content %}

    <div class="ui page grid">
        <div class="column">

            <div class="ui info attached icon message">
                <i class="user icon"></i>
                <div class="content">
                    <div class="header">
                        <h2 class="ui header">{{ membre.prenom|capitalize }} {{ membre.nom|capitalize }}</h2>
                    </div>
                    <p>{{ membre.activeAttribution.fonction.nom }} - {{ membre.activeAttribution.groupe.nom }}</p>
                </div>
            </div>
            <div class="ui attached segment">

                <div class="ui divided grid">

                    <div class="row"> <!-- informations de base -->

                        <div class="eight wide column">

                            <h4 class="ui header">Informations</h4>

                            {# Informations de base sur le membre #}
                            {{ form_row(membreForm.prenom) }}
                            {{ form_row(membreForm.naissance) }}
                            {{ form_row(membreForm.inscription) }}

                            <div class="ui divider"></div>

                            <div class="ui two column divided grid">
                                <div class="column">
                                    <h5 class="ui header">Téléphone(s)</h5>
                                    <table class="ui very basic small table">
                                        <thead>
                                            <tr>
                                                <th>Numéro</th>
                                                <th>Remarques</th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for tel in membre.contact.telephones %}
                                                <tr>
                                                    <td>{{ tel.telephone }}</td>
                                                    <td>{{ tel.remarques }}</td>
                                                    <td>
                                                        <i class="remove red link icon"></i>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>

                                <div class="column">
                                    <h5 class="ui header">E-mail(s)</h5>
                                </div>
                            </div>


                        </div>

                        <div class="eight wide column">     <!-- informations famille -->

                            <h4 class="ui header">Famille</h4>

                            {% set famille = membre.famille %}

                            <div class="ui list">
                                {% include 'AppBundle:Partials:partial_contact.html.twig' with {'contact' : famille.contact} %}
                            </div>

                            <h4>Frères et soeurs</h4>

                            <table class="ui very basic small table">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>Nom</th>
                                        <th>Role dans la BS</th>
                                    </tr>
                                </thead>
                                <tbody>

                                {% for gosse in membre.famille.membres %}
                                    {% if gosse.id != membre.id %}
                                        {% set sexeIcone = gosse.sexe == 'Personne::HOMME' ? "man" : "woman" %}
                                        <tr>
                                            <td><i class="{{ sexeIcone }} icon"></i></td>
                                            <td>
                                                <a data-position="left center" class="popupable" href="{{ path('interne_voir_membre', {membre: gosse.id}) }}">{{ gosse.prenom|capitalize }} {{ gosse.nom|capitalize }}</a>
                                                {% include 'AppBundle:Popup:popup_membre.html.twig' with {'membre' : gosse, 'blocks' : ['personal', 'scout']} %}
                                            </td>
                                            <td>{{ gosse.activeAttribution.fonction.nom }} - {{ gosse.activeAttribution.groupe.nom }}</td>
                                        </tr>
                                    {% endif %}

                                {% endfor %}

                                </tbody>
                            </table>

                        </div> <!-- /informations famille -->
                    </div> <!-- /informations de base -->
                </div>
                <div class="ui grid">

                    <div class="one column row">
                        <h3 class="ui horizontal divider">
                            Aux scouts
                        </h3>
                    </div>

                    <div class="row"> <!-- attributions et distinctions -->

                        <div class="five wide column">

                            <h4 class="ui header">Distinctions</h4>

                            <table class="ui small very basic table">
                                <thead>
                                    <tr>
                                        <th>Distinction</th>
                                        <th>Obtention</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for distinction in membre.distinctions %}
                                        <tr>
                                            <td>{{ distinction.distinction.nom }}</td>
                                            <td>{{ distinction.date|date("d.m.Y") }}</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>

                        <div class="eleven wide column">
                            <h4 class="ui header">Attributions</h4>

                            <table class="ui small very basic four column table">
                                <thead>
                                <tr>
                                    <th>Fonction</th>
                                    <th>Unité</th>
                                    <th>Début</th>
                                    <th>Fin</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for attribution in membre.attributions %}
                                    <tr style="{{ attrsMacros.generateBackground(attribution.dateDebut, attribution.dateFin) }}">
                                        <td>{{ attribution.fonction.nom }}</td>
                                        <td>{{ attribution.groupe.nom}}</td>
                                        <td>{{ attribution.dateDebut|date("d.m.Y") }}</td>
                                        <td>{{ attribution.dateFin is null ? '-' : attribution.dateFin|date("d.m.Y") }}</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>

                    </div> <!-- /attributions et distinctions -->

                </div>

            </div>

        </div>
    </div>



{% endblock %}


{% block css %}
    {% stylesheets '@AppBundle/Resources/public/css/Membre/membre.css' filter='cssrewrite' %}
    <link rel="stylesheet" href="{{ asset_url }}" />
    {% endstylesheets %}
{% endblock %}


{% block js %}

    <script type="text/javascript">
        $(document).ready(function() {
            $('.xeditable').editable();
        });
    </script>

    {# javscript pour l'interface du finance Bundle
    {% javascripts
    '@InterneFinancesBundle/Resources/public/js/creance.js'
    '@InterneFinancesBundle/Resources/public/js/facture.js'
    '@InterneFinancesBundle/Resources/public/js/rappel.js'
    '@InterneFinancesBundle/Resources/public/js/page_interface.js'
    '@InterneFinancesBundle/Resources/public/js/event_catcher.js'
    '@InterneFinancesBundle/Resources/public/js/liste.js'%}
    <script src="{{ asset_url }}"></script>

    {% endjavascripts %}




    {% javascripts
    '@AppBundle/Resources/public/js/editable.js'
    '@AppBundle/Resources/public/js/specials/validation_popup_generation.js'
    '@AppBundle/Resources/public/js/Membre/page_voir_membre.js'
    '@AppBundle/Resources/public/js/Contact/contact_form.js'
    %}
        <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts %}


#}

{% endblock %}

