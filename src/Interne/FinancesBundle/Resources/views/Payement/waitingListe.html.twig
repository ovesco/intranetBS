{% import "InterneFinancesBundle:Templates:liste.html.twig" as macro %}

{% set toolbar =
    {'search_bar':true,'selection_buttons':false,'paging':[10,20,50]}
%}

{% set headers = [['N°Réf.','Date','Montant recu','Montant emis','','Etat']]%}

{% set columns = ['payement.idFacture','payement.datePayement','payement.montantRecu','facture.montantEmis','facture.id','statut'] %}


{% set actions = [
{'icon':'red remove','label':'Ingoer le payement','event':'event_ignore_payement','conditions':[['statut','equal','not_found']]},
{'icon':'green check','label':'Valider le payement','event':'event_validate_payement','conditions':[['statut','equal','found_valid']]},
{'icon':'edit','label':'Répartir la somme','event':'event_repartition_payement','conditions':[['statut','equal','found_upper']]},
{'icon':'edit','label':'Valider le payement','event':'event_repartition_payement','conditions':[['statut','equal','found_lower']]},
{'icon':'red remove','label':'Ingoer le payement','event':'event_ignore_payement','conditions':[['statut','equal','found_payed']]},
] %}

{% set patterns = [
{'statut':'<i class="large red circle warning icon popupable" data-content="Facture inexistante pour ce payement"></i>','equal':'not_found'},
{'statut':'<i class="large green circle check icon popupable" data-content="Payement valide"></i>','equal':'found_valid'},
{'statut':'<i class="large yellow circle arrow up icon popupable" data-content="Montant supérieur"></i>','equal':'found_upper'},
{'statut':'<i class="large yellow circle arrow down icon popupable" data-content="Montant inférieur"></i>','equal':'found_lower'},
{'statut':'<i class="large yellow circle check icon popupable" data-content="Facture déjà payée"></i>','equal':'found_payed'},
{'facture.id':'<i class="zoom icon showFacture popupable" data-id="[data]" data-content="Voir la facture"></i>','diff':''},
{'payement.idFacture':'N°[data]'},
{'payement.montantRecu':'','equal':0},
{'facture.montantEmis':'','equal':0},
] %}


{% set filters = [
{'facture.montantEmis':'number_2'},
{'payement.montantRecu':'number_2'},
{'payement.datePayement':'date'},
] %}



{% if waitingListe is not empty %}
    {{ macro.liste('waiting_liste',waitingListe,headers,columns,actions,patterns,filters,toolbar) }}
{% else %}
    <div class="ui info message">Aucun payement en attente de validation</div>
{% endif %}