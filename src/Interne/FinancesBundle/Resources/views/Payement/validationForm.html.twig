{% form_theme form 'InterneFinancesBundle:Payement:factureRepartitionType.html.twig' %}

{% block content %}

<div class="ui segment">


    {% if payement.state == 'not_found' %}
        {% set color = 'red' %}
        {% set text = 'Facture introuvable pour ce payement' %}
        {% set icon = 'warning' %}
        {% set validation = '' %}
        {% set validation_text = 'Ingorer' %}
    {% elseif payement.state == 'found_already_payed' %}
        {% set color = 'orange' %}
        {% set text = 'Facture déjà payée précédement' %}
        {% set icon = 'warning' %}
        {% set validation = '' %}
        {% set validation_text = 'Ignorer' %}
    {% elseif payement.state == 'found_valid' %}
        {% set color = 'green' %}
        {% set text = 'Payement valide' %}
        {% set icon = 'checkmark' %}
        {% set validation = 'hidden' %}
        {% set validation_text = 'Valider' %}
    {% elseif payement.state == 'found_lower' %}
        {% set color = 'red' %}
        {% set text = 'Payement reçu avec montant insuffisant' %}
        {% set icon = 'caret down' %}
        {% set validation = 'hidden' %}
        {% set validation_text = 'Valider' %}
    {% elseif payement.state == 'found_upper' %}
        {% set color = 'green' %}
        {% set text = 'Payement reçu avec montant supérieure' %}
        {% set icon = 'caret up' %}
        {% set validation = 'hidden' %}
        {% set validation_text = 'Valider' %}
    {% endif %}


    <div class="ui top left attached {{ color }} label"><i class="{{ icon }} icon"></i></div>

    <table class="ui definition table">
        <tbody>
        <tr>
            <td>
                Facture
            </td>
            <td>
                N°{{ payement.idFacture }}
            </td>
        </tr>
        <tr>
            <td>
                Date de payement
            </td>
            <td>
                N°{{ payement.date|date(global_date_format) }}
            </td>
        </tr>
        <tr>
            <td>
                Etat
            </td>
            <td>
                <h5 class="ui {{ color }} header">{{ text }}</h5>
            </td>
        </tr>
        <tr>
            <td>
                Montant reçu
            </td>
            <td>
                {{ payement.montantRecu|money }}
            </td>
        </tr>
        </tbody>
    </table>


    {{ form_start(form, {'attr': {'class': 'ui form repartitionForm'}}) }}



    <div class="two fields">


        {{ form_widget(form.montantRecu,{'attr': {'class': 'montantRecu'}}) }}

        {{ form_widget(form.facture) }}

        {{ form_widget(form.comment) }}
    </div>

    <div class="field">
        <input {{ validation }} type="submit" value="{{ validation_text }}" class="submitRepartionForm ui blue button">
    </div>



    {{ form_rest(form) }}
    {{ form_end(form) }}
</div>

{% endblock %}
